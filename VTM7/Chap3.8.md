## 1.1    360-degree video coding tools

### 1.1.1    Horizontal wrap around motion compensation

The horizontal wrap around motion compensation in the VTM7 is a 360-specific coding tool designed to improve the visual quality of reconstructed 360-degree video in the equi-rectangular (ERP) projection format [5]. In conventional motion compensation, when a motion vector refers to samples beyond the picture boundaries of the reference picture, repetitive padding is applied to derive the values of the out-of-bounds samples by copying from those nearest neighbors on the corresponding picture boundary. For 360-degree video, this method of repetitive padding is not suitable, and could cause visual artefacts called “seam artefacts” in a reconstructed viewport video. Because a 360-degree video is captured on a sphere and inherently has no “boundary,” the reference samples that are out of the boundaries of a reference picture in the projected domain can always be obtained from neighboring samples in the spherical domain. For a general projection format, it may be difficult to derive the corresponding neighboring samples in the spherical domain, because it involves 2D-to-3D and 3D-to-2D coordinate conversion [5], as well as sample interpolation for fractional sample positions. This problem is much simpler for the left and right boundaries of the ERP projection format, as the spherical neighbors outside of the left picture boundary can be obtained from samples inside the right picture boundary, and vice versa. Given the wide usage of the ERP projection format, and the relative ease of implementation, the horizontal wrap around motion compensation was adopted in the VTM7 to improve the visual quality of 360-video coded in the ERP projection format. 

​                               

**Figure** **53** **– Horizontal wrap around motion compensation in VVC** 

The horizontal wrap around motion compensation process is as depicted in Figure 53. When a part of the reference block is outside of the reference picture’s left (or right) boundary in the projected domain, instead of repetitive padding, the “out-of-boundary” part is taken from the corresponding spherical neighbors that are located within the reference picture toward the right (or left) boundary in the projected domain. Repetitive padding is only used for the top and bottom picture boundaries. As depicted in Figure 53, the horizontal wrap around motion compensation can be combined with the non-normative padding method often used in 360-degree video coding (see padded ERP in [5]). In VVC, this is achieved by signaling a high level syntax element to indicate the wrap-around offset, which should be set to the ERP picture width before padding; this syntax is used to adjust the position of horizontal wrap around accordingly. This syntax is not affected by the specific amount of padding on the left and right picture boundaries, and therefore naturally supports asymmetric padding of the ERP picture, i.e., when left and right padding are different. The horizontal wrap around motion compensation provides more meaningful information for motion compensation when the reference samples are outside of the reference picture’s left and right boundaries. Under the 360 video CTC [4], this tool improves compression performance not only in terms of rate-distortion performance, but also in terms of reduced seam artefacts and improved subjective quality of the reconstructed 360-degree video. The horizontal wrap around motion compensation can also be used for other single face projection formats with constant sampling density in the horizontal direction, such as adjusted equal-area projection in 360Lib [5].